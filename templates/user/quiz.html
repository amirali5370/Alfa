{% extends "user/panel.html" %}
{% block head %}
    <title>آزمون ها | {{current_user.first_name}} {{current_user.last_name}}</title>
    <meta name="robots" content="noindex, nofollow">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/user/quiz.css') }}">
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">
    <meta name="more_of_page" content="{{ csrf_token() }}">
    <meta name="res_u" content="{{ url_for('user.result') }}">
{% endblock %}
{% block body %}
<div class="page-title">
    <h2>آزمون‌های من</h2>
</div>
  
  <!-- در حال برگزاری -->
<section class="exam-section">
    <h3>آزمون‌های در حال برگزاری</h3>
    <div class="exams-grid">
        {% for r in running %}
        <div class="exam-card live">
            <h4>{{r.title}}</h4>
            <p>زمان شروع: {{r.start_jalali}}<br>زمان پایان: {{r.end_jalali}}</p>
            <a href="{{ url_for('user.single_quiz', quiz_auth=r.auth) }}"><button class="exam-btn enter">ورود به آزمون</button></a>
        </div>
        {% else %}
        <div class="page-title">
            <h3 class="none_co">آزمونی درحال برگزاری برای شما موجود نیست!</h3>
        </div>
        {% endfor%}
    </div>
</section>
  
  <!-- آینده -->
<section class="exam-section">
    <h3>آزمون‌های آینده</h3>
    <div class="exams-grid">
        {% for u in upcoming %}
        <div class="exam-card upcoming">
            <h4>{{u.title}}</h4>
            <p>زمان شروع: {{u.start_jalali}}<br>زمان پایان: {{u.end_jalali}}</p>        
        </div>
        {% else %}
        <div class="page-title">
            <h3 class="none_co">آزمونی در آینده برای شما موجود نیست!</h3>
        </div>
        {% endfor%}
    </div>
</section>
  
  <!-- گذشته -->
<section class="exam-section">
    <h3>آزمون‌های گذشته</h3>
    <div class="exams-grid">
        {% for p in past %}
        <div class="exam-card past">
            <h4>{{p.title}}</h4>
            <p>زمان شروع: {{p.start_jalali}}<br>زمان پایان: {{p.end_jalali}}</p>
            <button class="exam-btn report" data-re="{{p.id}}">مشاهده کارنامه</button>
        </div>
        {% else %}
        <div class="page-title">
            <h3 class="none_co">آزمونی در گذشته برای شما موجود نیست!</h3>
        </div>
        {% endfor%}
    </div>
</section>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="{{ url_for('static', filename='scripts/user/quiz.js') }}"></script>

{% with messages = get_flashed_messages() %}
    {% if messages %}
        {% for message in messages %}
            {% if message == "quiz_success"%}
            <script type="module">
            Swal.fire({
                title: 'پاسخ شما با موفقیت ثبت شد!',
                html: 'بعد از اتمام زمان آزمون می توانید نمره خود را مشاهده کنید.',
                icon: 'success',
                confirmButtonColor: '#3f9b0b',
                confirmButtonText: '<div class="b123"><i class="i123 fa fa-times"></i> باشه</div>',
                showCloseButton: true,
                showLoaderOnConfirm:true,
                allowOutsideClick:false,
            }).then((result) => {swal.close();})
            </script>
            {% elif message == "quiz_more_3" %}
            <script type="module">
            Swal.fire({
                title: 'دفعات ورود بیش از حد مجاز!',
                html: 'متاسفانه شما تعداد دفعات مجاز ورود را رد کرده‌اید. می توانید برای مشاهده نتایج تا اتمام زمان آزمون صبر کنید.',
                icon: 'error',
                confirmButtonColor: '#dc1225',
                confirmButtonText: '<div class="b123"><i class="i123 fa fa-times"></i> باشه</div>',
                showCloseButton: true,
                showLoaderOnConfirm:true,
                allowOutsideClick:false,
            }).then((result) => {swal.close();})
            </script>
            {% endif %}
        {% endfor %}
    {% endif %}
{% endwith %}
{% endblock %}